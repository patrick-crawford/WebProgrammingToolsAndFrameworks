"use strict";(self.webpackChunkOERTemplate=self.webpackChunkOERTemplate||[]).push([[1024],{308:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"Working-With-Forms/processing-url-encoded-form-data","title":"Processing URL Encoded Form Data","description":"Processing URL Encoded Form Data","source":"@site/docs/Working-With-Forms/processing-url-encoded-form-data.md","sourceDirName":"Working-With-Forms","slug":"/Working-With-Forms/processing-url-encoded-form-data","permalink":"/WebProgrammingToolsAndFrameworks/Working-With-Forms/processing-url-encoded-form-data","draft":false,"unlisted":false,"editUrl":"https://github.com/catherine-leung/OERTemplate/tree/main/docs/Working-With-Forms/processing-url-encoded-form-data.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"processing-url-encoded-form-data","title":"Processing URL Encoded Form Data","sidebar_position":2,"description":"Processing URL Encoded Form Data"},"sidebar":"courseNotesSidebar","previous":{"title":"HTML Form Elements Review","permalink":"/WebProgrammingToolsAndFrameworks/Working-With-Forms/html-form-elements-review"},"next":{"title":"Processing Multipart Form Data","permalink":"/WebProgrammingToolsAndFrameworks/Working-With-Forms/processing-multipart-form-data"}}');var t=r(4848),i=r(8453);const s={id:"processing-url-encoded-form-data",title:"Processing URL Encoded Form Data",sidebar_position:2,description:"Processing URL Encoded Form Data"},a="Processing URL Encoded Form Data",d={},l=[{value:"Body Parsing Middleware",id:"body-parsing-middleware",level:2},{value:"Writing The Route Handler",id:"writing-the-route-handler",level:2},{value:"Special Consideration (&quot;checkbox&quot;)",id:"special-consideration-checkbox",level:3}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"processing-url-encoded-form-data",children:"Processing URL Encoded Form Data"})}),"\n",(0,t.jsxs)(n.p,{children:["Once we have completed the HTML to correctly ",(0,t.jsx)(n.strong,{children:"render"})," our <form> element, we can concentrate on handling the form submission within our server logic."]}),"\n",(0,t.jsxs)(n.p,{children:["Let's begin by first creating a ",(0,t.jsx)(n.a,{href:"/WebProgrammingToolsAndFrameworks/Web-Server-Introduction/simple-web-server-using-expressjs",children:"Simple Web Server using Express.js"}),' that returns a valid HTML document for the "/" route. Somewhere in the <body> of this document, create a simple form using controls from our ',(0,t.jsx)(n.a,{href:"/WebProgrammingToolsAndFrameworks/Working-With-Forms/html-form-elements-review",children:"HTML Form Elements Review"}),", for example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'<form method="post" action="/addEntry">\n  Full Name<br />\n  <input type="text" name="fullName" /><br /><br />\n\n  Blog Entry<br />\n  <textarea name="blogEntry"></textarea><br /><br />\n\n  Pet<br />\n  <select name="pet">\n    <option value="">-- Please choose an option --</option>\n    <option value="dog">Dog</option>\n    <option value="cat">Cat</option>\n    <option value="hamster">Hamster</option>\n    <option value="parrot">Parrot</option></select\n  ><br /><br />\n\n  Transportation<br />\n  <select multiple name="transportation">\n    <option value="car">Car</option>\n    <option value="motorcycle">Motorcycle</option>\n    <option value="bus">Bus</option>\n    <option value="jet">Private Jet</option></select\n  ><br /><br />\n\n  Fast Food<br />\n  <label><input type="radio" name="fastFood" value="hamburger" /> Hamburger </label><br />\n  <label><input type="radio" name="fastFood" value="pizza" /> Pizza </label><br />\n  <label><input type="radio" name="fastFood" value="sandwich" /> Sandwich </label><br /><br />\n\n  <label><input type="checkbox" name="active" /> Active </label><br /><br />\n\n  <input type="hidden" name="productID" value="193774" />\n\n  <button type="submit">Submit</button>\n</form>\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Notice how the form element has ",(0,t.jsx)(n.em,{children:"omitted"}),' the "enctype" attribute on the "form" element, as well as updated the action to ',(0,t.jsx)(n.code,{children:'"/addEntry"'})," (instead of ",(0,t.jsx)(n.code,{children:'"https://postman-echo.com/post"'}),"). This is because we will be using the ",(0,t.jsx)(n.strong,{children:"default"}),' enctype ("application/x-www-form-urlencoded") and we wish to process the form on our own server.']}),"\n",(0,t.jsx)(n.h2,{id:"body-parsing-middleware",children:"Body Parsing Middleware"}),"\n",(0,t.jsxs)(n.p,{children:["As mentioned in the ",(0,t.jsx)(n.a,{href:"/WebProgrammingToolsAndFrameworks/Advanced-Routing-Middleware/middleware",children:"Middleware"})," / ",(0,t.jsx)(n.a,{href:"/WebProgrammingToolsAndFrameworks/Advanced-Routing-Middleware/middleware#built-in-middleware",children:"Built-In Middleware"}),' discussion, we require some "preprocessing" on the "req" object, before we can access the form data in our routes. For example, if we were to submit the form now, the ',(0,t.jsx)(n.strong,{children:"data"})," sent would look something like this:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"fullName=John+Smith&blogEntry=Cool+Blog&pet=cat&transportation=car&transportation=bus&fastFood=pizza&active=on&productID=193774\n"})}),"\n",(0,t.jsx)(n.p,{children:"While it does contain the data from the form, it is very difficult to work with and requires manual parsing of the string. Instead, we would prefer an object in memory:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'{\n  fullName: "John Smith",\n  blogEntry: "Cool Blog",\n  pet: "cat",\n  transportation: [ "car", "bus" ],\n  fastFood: "pizza",\n  active: "on",\n  productID: "193774"\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:'This is where "Middleware" comes in, ie: perform some processing on the HTTP Request "body" data, before sending it to our route handlers in the "req" object.'}),"\n",(0,t.jsxs)(n.p,{children:["To achieve this, we can use the built-in middleware: ",(0,t.jsx)(n.a,{href:"/WebProgrammingToolsAndFrameworks/Advanced-Routing-Middleware/middleware#expressurlencoded",children:"express.urlencoded()"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"app.use(express.urlencoded({ extended: true }));\n"})}),"\n",(0,t.jsx)(n.h2,{id:"writing-the-route-handler",children:"Writing The Route Handler"}),"\n",(0,t.jsx)(n.p,{children:'In the example above, the form "action" attribute is set to "/addEntry". If the form were to be submitted now, Express would return a "404" error with a response containing the text "Cannot POST /addEntry".'}),"\n",(0,t.jsx)(n.p,{children:'To remedy this, create a "POST" route for "/addEntry":'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"app.post('/addEntry', (req, res) => {\n  res.send(req.body);\n});\n"})}),"\n",(0,t.jsx)(n.p,{children:'once the "/addEntry" route is in place (beneath our "express.urlencoded()" middleware), we can try submitting the form again. This time, we should see the form data rendered as JSON in the browser.'}),"\n",(0,t.jsx)(n.h3,{id:"special-consideration-checkbox",children:'Special Consideration ("checkbox")'}),"\n",(0,t.jsxs)(n.p,{children:["As previously mentioned in the ",(0,t.jsx)(n.a,{href:"/WebProgrammingToolsAndFrameworks/Working-With-Forms/html-form-elements-review#checkbox",children:'"checkbox" section'}),' of the "HTML Form Elements Review", checkboxes submit the string "on" when checked and ',(0,t.jsx)(n.em,{children:"undefined"})," when unchecked. Instead, we would prefer that the value be ",(0,t.jsx)(n.em,{children:"true"})," or ",(0,t.jsx)(n.em,{children:"false"}),". As a simple fix for this, we can add the following code:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"req.body.active = req.body.active ? true : false;\n"})}),"\n",(0,t.jsxs)(n.p,{children:['Here, we see if the "active" value is ',(0,t.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Glossary/Truthy",children:"truthy"}),' (ie: not false, 0, -0, 0n, "", null, undefined, or NaN) and if it is, set it explicitly to "true". If the value is "falsy" (ie: ',(0,t.jsx)(n.em,{children:"undefined"}),'), then set it explicitly to "false".']}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"app.post('/addEntry', (req, res) => {\n  req.body.active = req.body.active ? true : false;\n  res.send(req.body);\n});\n"})})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>a});var o=r(6540);const t={},i=o.createContext(t);function s(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);