"use strict";(self.webpackChunkOERTemplate=self.webpackChunkOERTemplate||[]).push([[7258],{5263:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Security-Considerations/secure-http-headers","title":"Secure HTTP Headers","description":"Secure HTTP Headers","source":"@site/docs/Security-Considerations/secure-http-headers.md","sourceDirName":"Security-Considerations","slug":"/Security-Considerations/secure-http-headers","permalink":"/WebProgrammingToolsAndFrameworks/Security-Considerations/secure-http-headers","draft":false,"unlisted":false,"editUrl":"https://github.com/catherine-leung/OERTemplate/tree/main/docs/Security-Considerations/secure-http-headers.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"id":"secure-http-headers","title":"Secure HTTP Headers","sidebar_position":3,"description":"Secure HTTP Headers"},"sidebar":"courseNotesSidebar","previous":{"title":"Password Encryption","permalink":"/WebProgrammingToolsAndFrameworks/Security-Considerations/password-encryption"},"next":{"title":"Example Code","permalink":"/WebProgrammingToolsAndFrameworks/Security-Considerations/example-code"}}');var n=r(4848),i=r(8453);const o={id:"secure-http-headers",title:"Secure HTTP Headers",sidebar_position:3,description:"Secure HTTP Headers"},a="Secure HTTP Headers",c={},d=[{value:"Introducing Helmet.js",id:"introducing-helmetjs",level:2}];function l(e){const s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"secure-http-headers",children:"Secure HTTP Headers"})}),"\n",(0,n.jsxs)(s.p,{children:["When attempting to secure our websites / apps, we have seen how to implement important features such as ",(0,n.jsx)(s.a,{href:"/WebProgrammingToolsAndFrameworks/Security-Considerations/https-introduction",children:'"HTTPS"'})," and ",(0,n.jsx)(s.a,{href:"/WebProgrammingToolsAndFrameworks/Security-Considerations/password-encryption",children:'"Password Encryption"'}),". However, there are other attacks such as ",(0,n.jsx)(s.a,{href:"https://owasp.org/www-community/attacks/xss/",children:'"Cross-Site Scripting (XSS)"'}),", ",(0,n.jsx)(s.a,{href:"https://owasp.org/www-community/attacks/csrf",children:'"Cross-Site Request Forgery (CSRF)"'}),", ",(0,n.jsx)(s.a,{href:"https://owasp.org/www-community/attacks/Clickjacking",children:'"Clickjacking Attacks"'}),", and so on that we must also consider. Fortunately, we can set a number of ",(0,n.jsx)(s.strong,{children:"headers"})," on our HTTP Responses that can help mitigate these issues, for example:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Content Security Policy"}),": This header can be used to control what resources the user agent is allowed to load for that page. For example, a page that uploads and displays images could allow images from anywhere, but restrict a form action to a specific endpoint. A properly designed Content Security Policy helps protect a page against a cross-site scripting attack."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"X-Frame-Options"}),': Tells the browser whether the website can be embedded in a frame or iframe. By setting the X-Frame-Options header to "DENY" or "SAMEORIGIN," we prevent the web application from being embedded in a frame from another domain, effectively mitigating clickjacking attacks.']}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"X-Permitted-Cross-Domain-Policies"}),": This header is used to limit which data external resources, such as PDF documents, can access on the domain. Failure to set the X-Permitted- Cross-Domain-Policies header to \u201cnone\u201d value allows other domains to embed the application\u2019s data in their content."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["and so on - see ",(0,n.jsx)(s.a,{href:"https://owasp.org/www-project-secure-headers/",children:"https://owasp.org/www-project-secure-headers"})," for more information."]}),"\n",(0,n.jsx)(s.h2,{id:"introducing-helmetjs",children:"Introducing Helmet.js"}),"\n",(0,n.jsxs)(s.p,{children:["To help us work with these secure headers, we can use an NPM module called ",(0,n.jsx)(s.a,{href:"https://helmetjs.github.io/",children:'"helmet.js"'}),". Helmet.js functions as middleware in our Node / Express.js applications that automatically sets or removes certain ",(0,n.jsx)(s.strong,{children:"response headers"})," in an effort to enhance security."]}),"\n",(0,n.jsxs)(s.p,{children:["To get started using helmet, we must install it from ",(0,n.jsx)(s.a,{href:"https://www.npmjs.com/package/helmet",children:"NPM"})," and ",(0,n.jsx)(s.strong,{children:"require"})," it in our server.js code:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"npm install helmet\n"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"const helmet = require('helmet');\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Once it is required, we can use the ",(0,n.jsx)(s.em,{children:"default configuration"}),' by simply invoking it an "app.use()" to register it as middleware, ie:']}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.use(helmet());\n"})}),"\n",(0,n.jsxs)(s.p,{children:["If you test an express server (ie: our ",(0,n.jsx)(s.a,{href:"/WebProgrammingToolsAndFrameworks/Web-Server-Introduction/simple-web-server-using-expressjs",children:'"simple web server"'}),") with this configuration, you should see a similar set of headers have been automatically added to the response:"]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Response Header"}),(0,n.jsx)(s.th,{children:"Value"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Content-Security-Policy"}),(0,n.jsx)(s.td,{children:"default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Cross-Origin-Opener-Policy"}),(0,n.jsx)(s.td,{children:"same-origin"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Cross-Origin-Resource-Policy"}),(0,n.jsx)(s.td,{children:"same-origin"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Origin-Agent-Cluster"}),(0,n.jsx)(s.td,{children:"?1"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Referrer-Policy"}),(0,n.jsx)(s.td,{children:"no-referrer"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"X-Content-Type-Options"}),(0,n.jsx)(s.td,{children:"nosniff"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"X-Dns-Prefetch-Control"}),(0,n.jsx)(s.td,{children:"off"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"X-Download-Options"}),(0,n.jsx)(s.td,{children:"noopen"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"X-Frame-Options"}),(0,n.jsx)(s.td,{children:"SAMEORIGIN"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"X-Permitted-Cross-Domain-Policies"}),(0,n.jsx)(s.td,{children:"none"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"X-Xss-Protection"}),(0,n.jsx)(s.td,{children:"0"})]})]})]}),"\n",(0,n.jsxs)(s.p,{children:["Additionally, the ",(0,n.jsx)(s.code,{children:"X-Powered-By"})," header has also been removed."]}),"\n",(0,n.jsxs)(s.p,{children:["For configuration options, see the ",(0,n.jsx)(s.a,{href:"https://helmetjs.github.io/",children:'"official Helmet.js documentation"'})]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,s,r)=>{r.d(s,{R:()=>o,x:()=>a});var t=r(6540);const n={},i=t.createContext(n);function o(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);