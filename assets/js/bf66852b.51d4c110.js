"use strict";(self.webpackChunkOERTemplate=self.webpackChunkOERTemplate||[]).push([[7626],{5496:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"Template-Engines/ejs-embedded-javaScript-templates","title":"EJS (Embedded JavaScript Templates)","description":"EJS (Embedded JavaScript Templates)","source":"@site/docs/Template-Engines/ejs-embedded-javaScript-templates.md","sourceDirName":"Template-Engines","slug":"/Template-Engines/ejs-embedded-javaScript-templates","permalink":"/WebProgrammingToolsAndFrameworks/Template-Engines/ejs-embedded-javaScript-templates","draft":false,"unlisted":false,"editUrl":"https://github.com/catherine-leung/OERTemplate/tree/main/docs/Template-Engines/ejs-embedded-javaScript-templates.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"ejs-embedded-javaScript-templates","title":"EJS (Embedded JavaScript Templates)","sidebar_position":2,"description":"EJS (Embedded JavaScript Templates)"},"sidebar":"courseNotesSidebar","previous":{"title":"Introduction","permalink":"/WebProgrammingToolsAndFrameworks/Template-Engines/introduction"},"next":{"title":"Example Code","permalink":"/WebProgrammingToolsAndFrameworks/Template-Engines/example-code"}}');var s=t(4848),i=t(8453);const r={id:"ejs-embedded-javaScript-templates",title:"EJS (Embedded JavaScript Templates)",sidebar_position:2,description:"EJS (Embedded JavaScript Templates)"},o="EJS (Embedded JavaScript Templates)",l={},d=[{value:"Getting Started",id:"getting-started",level:2},{value:"EJS Syntax",id:"ejs-syntax",level:2},{value:"Delimiters (Tags)",id:"delimiters-tags",level:3},{value:"Includes / &quot;Partials&quot;",id:"includes--partials",level:3},{value:"Logic",id:"logic",level:2},{value:"if / else",id:"if--else",level:3},{value:"Iterating over Collections",id:"iterating-over-collections",level:3},{value:"&quot;Nesting&quot; Logic",id:"nesting-logic",level:3},{value:"Layouts",id:"layouts",level:2}];function c(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"ejs-embedded-javascript-templates",children:"EJS (Embedded JavaScript Templates)"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://ejs.co/",children:"EJS"}),' is described as "a simple templating language that lets you generate HTML markup with plain JavaScript. No religiousness about how to organize things. No reinvention of iteration and control-flow. It\'s just plain JavaScript."']}),"\n",(0,s.jsxs)(n.p,{children:["It contains features that will help us generate HTML that renders complex data. For example, consider the problem with our \u201c/viewData\u201d route from the ",(0,s.jsx)(n.a,{href:"/WebProgrammingToolsAndFrameworks/Template-Engines/introduction",children:"introduction"}),"; we can leverage the EJS template engine to write a simple (separate) HTML5 document that references the data using special delimiters, ie: ",(0,s.jsx)(n.code,{children:"<%="})," and ",(0,s.jsx)(n.code,{children:"%>"}),", rather than returning a long, complex string from our route handler."]}),"\n",(0,s.jsx)(n.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,s.jsx)(n.p,{children:"To begin, create the following file in your \u201cviews\u201d directory and name it \u201cviewData.ejs\u201d:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<!DOCTYPE html>\n<html>\n  <head>\n    <title>View Data</title>\n  </head>\n\n  <body>\n    <table border="1">\n      <tr>\n        <th>Name</th>\n        <th>Age</th>\n        <th>Occupation</th>\n        <th>Company</th>\n      </tr>\n      <tr>\n        <td><%= data.name %></td>\n        <td><%= data.age %></td>\n        <td><%= data.occupation %></td>\n        <td><%= data.company %></td>\n      </tr>\n    </table>\n  </body>\n</html>\n'})}),"\n",(0,s.jsxs)(n.p,{children:["This is a much cleaner approach. We no longer have to generate the full page as a string within our \u201c/viewData\u201d route and most importantly, all of the ",(0,s.jsx)(n.strong,{children:"view"})," logic (HTML) is separate from our ",(0,s.jsx)(n.strong,{children:"control"})," logic (routing)."]}),"\n",(0,s.jsx)(n.p,{children:"In order to set this up correctly and get express to understand the file above, we need to modify our server code slightly:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The first thing that we need to do is download / install the EJS package using NPM. Open a terminal in Visual Studio Code (ctrl + ` or View -> Integrated Terminal) and make sure that your working directory is somewhere within your project and run the command"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install ejs\n"})}),"\n",(0,s.jsx)(n.p,{children:'This will install the "ejs" package in the same way that we installed the "express" package and update the dependencies in our package.json file:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'"dependencies": {\n  "ejs": ...,\n  "express": ..."\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:'Next, our server needs to know how to handle HTML files that are formatted using ejs, so near the top of our code (after we define our "app"), add the line:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"app.set('view engine', 'ejs');\n"})}),"\n",(0,s.jsx)(n.p,{children:'This will tell our server that any file with the ".ejs" extension (instead of ".html") will use the EJS "engine" (template engine).'}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:'The final step involves updating our "/viewData" route to "render" our EJS file with the data:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"app.get('/viewData', function (req, res) {\n  let someData = {\n    name: 'John',\n    age: 23,\n    occupation: 'developer',\n    company: 'Scotiabank',\n  };\n\n  res.render('viewData', {\n    data: someData,\n  });\n});\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Now, the route no longer returns a string consisting of our HTML + data using res.send(), but instead invokes the ",(0,s.jsx)(n.a,{href:"http://expressjs.com/en/api.html#res.render",children:"render"})," method on the ",(0,s.jsx)(n.a,{href:"http://expressjs.com/en/api.html#res",children:"response"}),' object (res). We pass the name of our new file without the extension (ie: "viewData" instead of "viewData.ejs"), and a "data" object to hold all of our data (someData).']}),"\n",(0,s.jsx)(n.h2,{id:"ejs-syntax",children:"EJS Syntax"}),"\n",(0,s.jsxs)(n.p,{children:["Before we begin to discuss the more advanced features of EJS, we must first become familiar with the syntax. For example, we have seen that ",(0,s.jsx)(n.code,{children:"<%= ... %>"}),' is used to render a specific value within our template. However, we should understand that this delimiter ("tag"), ',(0,s.jsx)(n.em,{children:"also"}),' escapes any HTML contained in the value (ie: "<br />" will be rendered as "&lt;br /&gt;" so that it appears as text, ',(0,s.jsx)(n.em,{children:"instead"})," of a new line)."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"<%= ... %>"})," is not the only delimiter available to us. EJS also provides a number of ",(0,s.jsx)(n.em,{children:"opening"})," and ",(0,s.jsx)(n.em,{children:"closing"}),' delimiters ("tags") that control how a value is rendered within the template.']}),"\n",(0,s.jsx)(n.h3,{id:"delimiters-tags",children:"Delimiters (Tags)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"<%= ... %>"})})," (HTML Escaped)"]}),"\n",(0,s.jsxs)(n.p,{children:["As we have seen, this tag outputs the value into the template (HTML escaped). For example: ",(0,s.jsx)(n.code,{children:"<br />"})," will be rendered as: ",(0,s.jsx)(n.code,{children:"&lt;br /&gt;"}),", when using the tag:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<%= someValue %>\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"<%- ... %>"})})," (Unescaped)"]}),"\n",(0,s.jsxs)(n.p,{children:["This tag works exactly as the above ",(0,s.jsx)(n.code,{children:"<%="})," tag, except the value is ",(0,s.jsx)(n.em,{children:"not"})," HTML escaped.For example: ",(0,s.jsx)(n.code,{children:"<br />"})," will be rendered as: ",(0,s.jsx)(n.code,{children:"<br />"}),", when using the tag:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<%- someValue %>\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"<%# ... %>"})})," (Comment)"]}),"\n",(0,s.jsxs)(n.p,{children:["This tag is used when we wish add a comment to our templates that will ",(0,s.jsx)(n.strong,{children:"not"})," be output in the final HTML, ie:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<%# This is a comment that will not be rendered %>\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"<% ... %>"})})," (Scriptlet)"]}),"\n",(0,s.jsxs)(n.p,{children:["This is the tag that will enable us to insert ",(0,s.jsx)(n.strong,{children:"logic"}),' into our templates (discussed further down). For example, if our "data" object contained an array of colors, ie: ',(0,s.jsx)(n.code,{children:"['red','green','blue']"}),', we could use the following "scriptlet" tags to render the contents using a "forEach" loop:']}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ejs",children:"<% data.colors.forEach((color) => { %>\n  <%= color %>\n<% }) %>\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:'Delimiters that output a value (ie "HTML escaped" / "unescaped") are also capable of executing JavaScript expressions. For example, if "someValue" is a string, we could use the following code:'}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"<%= someValue.toUpperCase() %>"})})]}),"\n",(0,s.jsx)(n.h3,{id:"includes--partials",children:'Includes / "Partials"'}),"\n",(0,s.jsx)(n.p,{children:'When using EJS, it is also possible to place reusable blocks of our user interface in separate files, such as a common header or an in-page modal window / dialog box. To achieve this, EJS uses an "include" function that may be used in one of the output tags (ie: "HTML escaped" or "unescaped", however since these included .ejs files typically use HTML, the "unescaped" delimiter is more commonly used).'}),"\n",(0,s.jsx)(n.p,{children:'To see how this works in practice, we will create a "partials" folder within the "views" folder (this will help us separate the reusable templates, from the "page" templates)'}),"\n",(0,s.jsxs)(n.p,{children:['Next, (within the "partials" folder) create a file called ',(0,s.jsx)(n.strong,{children:'"header.ejs"'}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<h1>EJS Practice - <%= page %></h1>\n<hr />\n<a href="/">Home</a> | <a href="/about">About</a> | <a href="/viewData">View Data</a>\n<hr />\n<br />\n'})}),"\n",(0,s.jsxs)(n.p,{children:['Notice how our partial template includes a block of reusable HTML as well as an "HTML escaped" tag to render a variable called "page". To render this template ',(0,s.jsx)(n.em,{children:"inside"}),' another template, we can use the aforementioned "include" function:']}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"File: viewData.ejs"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<%- include('partials/header', {page: '/viewData'}) %>\n"})}),"\n",(0,s.jsx)(n.p,{children:'Here, we have used the "unescaped" delimiter to ensure that the HTML within the "partial" is correctly rendered. Additionally, the second parameter contains an object that we an pass to our partial (in this case, the value of the "page" variable)'}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:'Partial views have access to the data in the template in which they are placed. For example, if the "header" partial (above) was placed in the viewData template, it would have access to the "data" object and could render "data.name", for example'})}),"\n",(0,s.jsx)(n.h2,{id:"logic",children:"Logic"}),"\n",(0,s.jsxs)(n.p,{children:['Using the "Scriptlet" delimiter (ie: ',(0,s.jsx)(n.code,{children:"<% ... %>"}),"), we can easily insert JavaScript code into our templates. This is one of the key benefits of using EJS:"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\"We love JavaScript. It's a totally friendly language. All templating languages grow to be Turing-complete. Just cut out the middle-man, and use JS!"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://ejs.co/",children:"https://ejs.co"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"if--else",children:"if / else"}),"\n",(0,s.jsx)(n.p,{children:'To conditionally render portions of our template (HTML), we can use a simple if / else statement. To get this to work correctly, each "line" of JavaScript code should be placed inside a scriptlet delimiter. For example, say we wish to conditionally show our developer "John":'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"let someData = {\n  name: 'John',\n  age: 23,\n  occupation: 'developer',\n  company: 'Scotiabank',\n  visible: true,\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:'Notice, we have added a "visible" property that we can reference before we render "someData" in our view. Using a simple if / else statement, we can easily hide or show rows in the table:'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"File: viewData.ejs"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<% if (data.visible) { %>\n  <tr>\n    <td><%= data.name %></td>\n    <td><%= data.age %></td>\n    <td><%= data.occupation %></td>\n    <td><%= data.company %></td>\n  </tr>\n<% } else { %>\n  <tr>\n    <td colspan=\"4\">User: '<%= data.name %>' has hidden their information</td>\n  </tr>\n<% } %>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"iterating-over-collections",children:"Iterating over Collections"}),"\n",(0,s.jsxs)(n.p,{children:['In addition to conditionally rendering portions of our templates, we may also need to display the content of an array / collection. This may be done using the usual constructs, ie "for", "for...of", "while", "forEach()", etc. For example, if our someData object contained an ',(0,s.jsx)(n.strong,{children:"array"})," of objects:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"let someData = [\n  {\n    name: 'John',\n    age: 23,\n    occupation: 'developer',\n    company: 'Scotiabank',\n  },\n  {\n    name: 'Sarah',\n    age: 32,\n    occupation: 'manager',\n    company: 'TD',\n  },\n];\n"})}),"\n",(0,s.jsx)(n.p,{children:'we could use the "forEach()" method to display each object in our table:'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"File: viewData.ejs"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<% data.forEach(user=>{ %>\n  <tr>\n    <td><%= user.name %></td>\n    <td><%= user.age %></td>\n    <td><%= user.occupation %></td>\n    <td><%= user.company %></td>\n  </tr>\n<% }) %>\n"})}),"\n",(0,s.jsx)(n.p,{children:'Please note that we are not limited to the forEach() loop when iterating over data. As mentioned above, we could also use another construct, such as the "for...of" loop:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<% for (const user of data){ %>\n  <tr>\n    <td><%= user.name %></td>\n    <td><%= user.age %></td>\n    <td><%= user.occupation %></td>\n    <td><%= user.company %></td>\n  </tr>\n<% } %>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"nesting-logic",children:'"Nesting" Logic'}),"\n",(0,s.jsx)(n.p,{children:'The "scriptlet" tag is extremely powerful - it let\'s us inject JavaScript into our views to control how our data is displayed. In the above examples, we have only used single pieces of logic at a time (ie: "if/else", "forEach()", etc), but it is also possible that this logic may be "nested".'}),"\n",(0,s.jsxs)(n.p,{children:['For example, maybe each of our "users" in the "someData" array has a "visible" property as well. We would like to render each of the elements in the array, but ',(0,s.jsx)(n.strong,{children:"also"})," hide a user if their visible property is set to ",(0,s.jsx)(n.em,{children:"false"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"let someData = [\n  {\n    name: 'John',\n    age: 23,\n    occupation: 'developer',\n    company: 'Scotiabank',\n    visibility: false,\n  },\n  {\n    name: 'Sarah',\n    age: 32,\n    occupation: 'manager',\n    company: 'TD',\n    visibility: true,\n  },\n];\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"File: viewData.ejs"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<% for (const user of data){ %>\n  <% if(user.visible){ %>\n    <tr>\n      <td><%= user.name %></td>\n      <td><%= user.age %></td>\n      <td><%= user.occupation %></td>\n      <td><%= user.company %></td>\n    </tr>\n  <% }else{ %>\n    <tr>\n      <td colspan=\"4\">User: '<%= user.name %>' has hidden their information</td>\n    </tr>\n  <% } %>\n<% } %>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"layouts",children:"Layouts"}),"\n",(0,s.jsx)(n.p,{children:'EJS does not natively support "layouts". Typically, the structure of an application using EJS as its template engine will feature a common "header, "footer", "sidebar", etc with every page, ie:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<body>\n  <%- include('header') %>\n\n  <%# Page Content / Data Here %>\n\n  <%- include('footer') %>\n</body>\n"})}),"\n",(0,s.jsx)(n.p,{children:"If you wish to customize the 'header' or 'footer' based on the current page, data can be sent to each of the partials separately. For example, one common task is for a navigation bar within the 'header' to highlight the link for the current page. For example, if the user is currently viewing the \"/about\" route, then \"About\" should be highlighted:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"File: header.ejs"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<h1>EJS Practice - <%= page %></h1>\n<hr />\n<a href="/">Home</a> | <a href="/about"><strong>About</strong></a> | <a href="/viewData">View Data</a>\n<hr />\n<br />\n'})}),"\n",(0,s.jsx)(n.p,{children:'To achieve this, we can pass the current route to the partial view. Currently, we are passing this value as "page":'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"File: viewData.ejs"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<%- include('partials/header', {page: '/viewData'}) %>\n"})}),"\n",(0,s.jsx)(n.p,{children:'Therefore, we can leverage the "unescaped" tag to conditionally highlight each of the options using the "ternary" operator, by checking the "href" attribute against the "page" value:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<h1>EJS Practice - <%= page %></h1>\n<hr />\n  <a href=\"/\"><%- (page==\"/\") ? '<strong>Home</strong>' : 'Home' %></a> |\n  <a href=\"/about\"><%- (page==\"/about\") ? '<strong>About</strong>' : 'About' %></a> |\n  <a href=\"/viewData\"><%- (page==\"/viewData\") ? '<strong>View Data</strong>' : 'View Data' %></a>\n<hr />\n<br />\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["If you wish to use EJS with full layout support, consider the NPM package: ",(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/express-ejs-layouts",children:"express-ejs-layouts"})]})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var a=t(6540);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);