"use strict";(self.webpackChunkOERTemplate=self.webpackChunkOERTemplate||[]).push([[2927],{8453:(e,s,t)=>{t.d(s,{R:()=>a,x:()=>i});var r=t(6540);const n={},o=r.createContext(n);function a(e){const s=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),r.createElement(o.Provider,{value:s},e.children)}},9366:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Advanced-Routing-Middleware/application-request-response-objects","title":"Application, Request & Response Objects","description":"Application, Request & Response Objects","source":"@site/docs/Advanced-Routing-Middleware/application-request-response-objects.md","sourceDirName":"Advanced-Routing-Middleware","slug":"/Advanced-Routing-Middleware/application-request-response-objects","permalink":"/WebProgrammingToolsAndFrameworks/Advanced-Routing-Middleware/application-request-response-objects","draft":false,"unlisted":false,"editUrl":"https://github.com/catherine-leung/OERTemplate/tree/main/docs/Advanced-Routing-Middleware/application-request-response-objects.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"application-request-response-objects","title":"Application, Request & Response Objects","sidebar_position":1,"description":"Application, Request & Response Objects"},"sidebar":"courseNotesSidebar","previous":{"title":"Example Code","permalink":"/WebProgrammingToolsAndFrameworks/UI-Toolkits/example-code"},"next":{"title":"Middleware","permalink":"/WebProgrammingToolsAndFrameworks/Advanced-Routing-Middleware/middleware"}}');var n=t(4848),o=t(8453);const a={id:"application-request-response-objects",title:"Application, Request & Response Objects",sidebar_position:1,description:"Application, Request & Response Objects"},i="Application, Request & Response Objects",l={},d=[{value:"The Application object",id:"the-application-object",level:2},{value:"app.all()",id:"appall",level:3},{value:"HTTP Verb Methods",id:"http-verb-methods",level:3},{value:"app.locals",id:"applocals",level:3},{value:"app.listen()",id:"applisten",level:3},{value:"app.set()",id:"appset",level:3},{value:"app.use()",id:"appuse",level:3},{value:"The Request object",id:"the-request-object",level:2},{value:"req.body",id:"reqbody",level:3},{value:"req.cookies",id:"reqcookies",level:3},{value:"req.params",id:"reqparams",level:3},{value:"req.query",id:"reqquery",level:3},{value:"req.get()",id:"reqget",level:3},{value:"The Response object",id:"the-response-object",level:2},{value:"res.cookie()",id:"rescookie",level:3},{value:"res.set()",id:"resset",level:3},{value:"res.end()",id:"resend",level:3},{value:"res.redirect()",id:"resredirect",level:3},{value:"res.send()",id:"ressend",level:3},{value:"res.sendFile()",id:"ressendfile",level:3},{value:"res.status()",id:"resstatus",level:3}];function c(e){const s={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"application-request--response-objects",children:"Application, Request & Response Objects"})}),"\n",(0,n.jsxs)(s.p,{children:['Express.js makes it very straightforward to get a web server running on a given port and responding to simple "get" requests (ie: ',(0,n.jsx)(s.code,{children:"GET / HTTP/1.1"}),"):"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"const express = require('express');\nconst app = express();\n\nconst HTTP_PORT = process.env.PORT || 8080;\n\napp.get('/', (req, res) => {\n  res.send('Hello World');\n});\n\napp.listen(HTTP_PORT, () => console.log(`server listening on: ${HTTP_PORT}`));\n"})}),"\n",(0,n.jsxs)(s.p,{children:["From the above code, it is clear that there are three important objects that are used to configure the server: ",(0,n.jsx)(s.code,{children:"app"}),", ",(0,n.jsx)(s.code,{children:"req"})," and ",(0,n.jsx)(s.code,{children:"res"}),". Let's discuss these objects in detail and how we can use them to handle more complicated scenarios, such as route / query parameters, cookies and custom errors."]}),"\n",(0,n.jsx)(s.h2,{id:"the-application-object",children:"The Application object"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.a,{href:"https://expressjs.com/en/api.html#app",children:'"app"'})," object in the example above represents the express main application object. It contains several methods for tasks, such as processing route requests, setting up middleware, and managing html views or view engines."]}),"\n",(0,n.jsx)(s.p,{children:'In the above example, we set a route on the host to handle HTTP GET requests to \u201c/\u201d. This means any "GET" requests to localhost:8080/ will be sent to this function. A typical route handler in express (like the one above) is created by invoking a function on the app object using the HTTP method (verb) that matches the type of request and passing it two parameters: a string representing the route, and a callback function to invoke when the route is matched. In this case, we wish to handle GET requests for the default route "/" (typically requests from the browser to load the page initially).'}),"\n",(0,n.jsx)(s.p,{children:"Here are some of the commonly used application properties and methods that we will use throughout these notes."}),"\n",(0,n.jsx)(s.h3,{id:"appall",children:"app.all()"}),"\n",(0,n.jsxs)(s.p,{children:["This method is used to register a single callback for a route that matches ",(0,n.jsx)(s.em,{children:"any"})," ",(0,n.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods",children:"HTTP Method"})," IE: GET, PUT, POST, DELETE, etc."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.all('/http-testing', (req, res) => {\n  res.send('test complete');\n});\n"})}),"\n",(0,n.jsx)(s.h3,{id:"http-verb-methods",children:"HTTP Verb Methods"}),"\n",(0,n.jsxs)(s.p,{children:["We can also respond to a request a callback for a route using a ",(0,n.jsx)(s.em,{children:"single"})," HTTP Method (ie: ",(0,n.jsx)(s.code,{children:"app.get()"})," from our ",(0,n.jsx)(s.a,{href:"/WebProgrammingToolsAndFrameworks/Web-Server-Introduction/simple-web-server-using-expressjs#simple-get-routes",children:"Simple Web Server using Express.js"})," example):"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.get('/get-test', (req, res) => {\n  res.send('GET Test Complete');\n});\n\napp.put('/put-test', (req, res) => {\n  res.send('PUT Test Complete');\n});\n\napp.post('/post-test', (req, res) => {\n  res.send('POST Test Complete');\n});\n\napp.delete('/delete-test', (req, res) => {\n  res.send('DELETE Test Complete');\n});\n\n// etc.\n"})}),"\n",(0,n.jsx)(s.h3,{id:"applocals",children:"app.locals"}),"\n",(0,n.jsxs)(s.p,{children:['The "locals" property allows you to attach local variables to the application, which persist throughout the life of the app. You can access local variables in templates rendered within the application (discussed in ',(0,n.jsx)(s.a,{href:"/WebProgrammingToolsAndFrameworks/Template-Engines/introduction",children:'"Template Engines"'}),")."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.locals.title = 'My App';\n"})}),"\n",(0,n.jsx)(s.h3,{id:"applisten",children:"app.listen()"}),"\n",(0,n.jsx)(s.p,{children:"As we have seen, this function is used to start the HTTP server listening for connections on a specific port, ie:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"const HTTP_PORT = process.env.PORT || 8080;\n\n// (route handlers / middleware) ...\n\napp.listen(HTTP_PORT, () => {\n  console.log('server listening on: ' + HTTP_PORT);\n});\n"})}),"\n",(0,n.jsx)(s.h3,{id:"appset",children:"app.set()"}),"\n",(0,n.jsxs)(s.p,{children:['The "set" method assigns a value to a specific "setting". According to the documentation, you may store any value that you want in your own custom "setting", however ',(0,n.jsx)(s.a,{href:"https://expressjs.com/en/5x/api.html#app.settings.table",children:"certain settings"}),' can be used to configure the behavior of the server. For example, we will be setting the value of the "view engine" setting when configuring our template engine.']}),"\n",(0,n.jsx)(s.h3,{id:"appuse",children:"app.use()"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.em,{children:"use"})})," method is used to add middleware to your application. Middleware consists of functions (typically placed before the route handlers) that automatically execute either when a specified path is matched or globally before every request. This is very useful when you want to do something with every request like add properties to the request object or check if a user is logged in."]}),"\n",(0,n.jsxs)(s.p,{children:["This is discussed further in the next section: ",(0,n.jsx)(s.a,{href:"/WebProgrammingToolsAndFrameworks/Advanced-Routing-Middleware/middleware",children:'"Middleware"'})]}),"\n",(0,n.jsx)(s.h2,{id:"the-request-object",children:"The Request object"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.a,{href:"https://expressjs.com/en/api.html#req",children:'"req"'})," object represents the object that contains all the information and metadata for the request sent ",(0,n.jsx)(s.em,{children:"to"})," the server. When you see examples of the request object in use, it will typically be referred to as \u2018req\u2019 (short for request object)."]}),"\n",(0,n.jsx)(s.p,{children:"Some of the commonly used request properties and methods used throughout these notes are:"}),"\n",(0,n.jsx)(s.h3,{id:"reqbody",children:"req.body"}),"\n",(0,n.jsxs)(s.p,{children:['The req.body property contains the data submitted as part of request. It requires that you use a "body parsing" middleware (discussed in: ',(0,n.jsx)(s.a,{href:"/WebProgrammingToolsAndFrameworks/Advanced-Routing-Middleware/middleware",children:'"Middleware"'}),") which will attach data (properties) to req.body. If you post data in your request, this is how you access that data."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.post('/urlencoded-test', (req, res) => {\n  res.send(req.body);\n});\n"})}),"\n",(0,n.jsx)(s.h3,{id:"reqcookies",children:"req.cookies"}),"\n",(0,n.jsx)(s.p,{children:'If we wish to read the value specific "cookie" value, ie:'}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsx)(s.p,{children:'"a small piece of data that a server sends to a user\'s web browser. The browser may store the cookie and send it back to the same server with later requests."'}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies",children:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies"})}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:'we can reference it using the corresponding property on the "req.cookies" object:'}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:'// Cookie: name=tj\nconsole.log(req.cookies.name); // "tj"\n'})}),"\n",(0,n.jsx)(s.p,{children:'However, like "req.body" above, we must use a ("cookie parsing") middleware function to populate "req.cookies" with data from the cookie'}),"\n",(0,n.jsx)(s.h3,{id:"reqparams",children:"req.params"}),"\n",(0,n.jsx)(s.p,{children:'The "params" property is used when we wish to read the values of "Route Parameters" defined in our route handlers:'}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:['"Route parameters are named URL segments used to capture values at specific positions in the URL. The named segments are prefixed with a colon and then the name (E.g., /',":your_parameter_name",'/)."']}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Learn/Server-side/Express_Nodejs/routes#route_parameters",children:"https://developer.mozilla.org/en-US/docs/Learn/Server-side/Express_Nodejs/routes#route_parameters"})}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:['For example, if we wish to match all GET requests for the route "/employee/',(0,n.jsx)(s.strong,{children:"employeeNum"}),'", where ',(0,n.jsx)(s.strong,{children:"employeeNum"})," can be ",(0,n.jsx)(s.em,{children:"any"}),' value, ie: "123", "abc456", etc, we can use the following code:']}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.get('/employee/:employeeNum', (req, res) => {\n  res.send(`Employee Number: ${req.params.employeeNum}`);\n});\n"})}),"\n",(0,n.jsx)(s.h3,{id:"reqquery",children:"req.query"}),"\n",(0,n.jsx)(s.p,{children:'The "query" property is needed when we wish to read the values of the "query string" in the url:'}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsx)(s.p,{children:"A query string is a part of a uniform resource locator (URL) that assigns values to specified parameters. A query string commonly includes fields added to a base URL by a Web browser or other client application, for example as part of an HTML document, choosing the appearance of a page, or jumping to positions in multimedia content"}),"\n",(0,n.jsxs)(s.p,{children:["A typical URL containing a query string is as follows: ",(0,n.jsx)(s.code,{children:"https://example.com/over/there?name=ferret"})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Query_string",children:"https://en.wikipedia.org/wiki/Query_string"})}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:['For example, if we wanted to match a GET request for the route "/products" that ',(0,n.jsx)(s.em,{children:"also"}),' supports the optional query string value "onSale", ie: "/products?onSale=true", we could use the code:']}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.get('/products', (req, res) => {\n  let result = 'all Products';\n\n  // NOTE: query parameter values are always strings\n\n  if (req.query.onSale == 'true') {\n    result += ' (on sale)';\n  }\n\n  res.send(result);\n});\n"})}),"\n",(0,n.jsxs)(s.p,{children:['When designing route handlers that can accept query string values, we do not include them in the "route" (ie: "/products"). Additionally, since the route will match ',(0,n.jsx)(s.em,{children:"without"}),' the "onSale" query sting value, it is important to return a value if it\'s missing (ie: "all Products" or an error if the query parameter ',(0,n.jsx)(s.em,{children:"must"})," be present)"]}),"\n",(0,n.jsx)(s.admonition,{type:"info",children:(0,n.jsxs)(s.p,{children:['Multiple query parameters may also be used, and are separated by an ampersand, "&": ',(0,n.jsx)(s.code,{children:"https://example.com/path/to/page?name=ferret&color=purple"})]})}),"\n",(0,n.jsx)(s.h3,{id:"reqget",children:"req.get()"}),"\n",(0,n.jsx)(s.p,{children:"req.get() is necessary for checking the values of specific HTTP headers sent with the request. For example:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.get('/hello', (req, res) => {\n  res.send(`Hello ${req.get('user-agent')}`);\n});\n"})}),"\n",(0,n.jsxs)(s.p,{children:['Here, when a user requests the "/hello" route, they should see the text "Hello" followed by the content of the ',(0,n.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent",children:'"user-agent"'})," header sent with the request."]}),"\n",(0,n.jsx)(s.h2,{id:"the-response-object",children:"The Response object"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.a,{href:"https://expressjs.com/en/api.html#res",children:'"res"'})," object represents the object that contains all the information and metadata for a response sent ",(0,n.jsx)(s.em,{children:"from"})," the server. When you see examples of the response object in use it will typically be referred to as \u2018res\u2019 (short for response object). The data you send back from the server can be one of several different formats - the most common of which are HTML, JSON, CSS, JS and plain files (.pdf, .txt, .jpg, .png, etc)."]}),"\n",(0,n.jsx)(s.p,{children:"Some of the commonly used response properties and methods used throughout these notes are:"}),"\n",(0,n.jsx)(s.h3,{id:"rescookie",children:"res.cookie()"}),"\n",(0,n.jsx)(s.p,{children:'This allows you to send a cookie with the response, specified using a name = value key pair. You can set the value to a string / object using JSON notation and it will be included in the "Set-Cookie" header of the response. For example:'}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.get('/cookie-test', (req, res) => {\n  res.cookie('message', 'Hello World!');\n  res.send('Cookie Sent!');\n});\n"})}),"\n",(0,n.jsx)(s.h3,{id:"resset",children:"res.set()"}),"\n",(0,n.jsx)(s.p,{children:"res.set() enables you to set the values of specific / custom HTTP headers sent with the request. For example:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.get('/custom', (req, res) => {\n  res.set('Custom-Header', 'MyValue');\n  res.send(`Custom-Header Sent`);\n});\n"})}),"\n",(0,n.jsx)(s.h3,{id:"resend",children:"res.end()"}),"\n",(0,n.jsxs)(s.p,{children:["res.end() is used you want to end a response immediately and send nothing back. For example, we may wish to send a ",(0,n.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/204",children:'"204 - No Content"'}),' status code, which indicates that "a request has succeeded, but that the client doesn\'t need to navigate away from its current page". For example:']}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.put('/update', (req, res) => {\n  // ... (update logic)\n  res.status(204).end();\n});\n"})}),"\n",(0,n.jsx)(s.h3,{id:"resredirect",children:"res.redirect()"}),"\n",(0,n.jsx)(s.p,{children:"The res.redirect() method is used to perform a redirect to another page on your site, go back to the previous page, or redirect to another domain. For example:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.get('/to-google', (req, res) => {\n  res.redirect('https://www.google.ca/');\n});\n"})}),"\n",(0,n.jsx)(s.h3,{id:"ressend",children:"res.send()"}),"\n",(0,n.jsx)(s.p,{children:"This is the primary response method to send a response to the client. You can send a String, Object, Array, or even a Buffer object back to the client. The send() method will automatically set the Content-Type header for you based on the type of data sent. For example:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.get('/json-test', (req, res) => {\n  res.send({ message: 'Hello World!' }); // Content-Type: application/json; charset=utf-8\n});\n\napp.get('/plain-text-test', (req, res) => {\n  res.send('Hello World!'); // Content-Type: text/html; charset=utf-8\n});\n"})}),"\n",(0,n.jsx)(s.admonition,{type:"info",children:(0,n.jsx)(s.p,{children:'When sending a JavaScript object back (as in the example above), the "send()" method will internally convert it to a JSON-formatted string'})}),"\n",(0,n.jsx)(s.h3,{id:"ressendfile",children:"res.sendFile()"}),"\n",(0,n.jsxs)(s.p,{children:["As we have seen, this function is used when we wish to send a file (typically .html) back to the client. We use ",(0,n.jsx)(s.a,{href:"https://nodejs.org/api/path.html#pathjoinpaths",children:"path.join()"})," to safely join ",(0,n.jsx)(s.a,{href:"https://nodejs.org/docs/latest/api/modules.html#__dirname",children:"__dirname"})," with the path of the file to be sent. This function also correctly sets the Content-Type response HTTP header based on the file extension. For example:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"app.get('/', (req, res) => {\n  res.sendFile(path.join(__dirname, '/views/home.html'));\n});\n"})}),"\n",(0,n.jsx)(s.h3,{id:"resstatus",children:"res.status()"}),"\n",(0,n.jsxs)(s.p,{children:["res.status() is used to set a specific status code for the response (as seen above in the ",(0,n.jsx)(s.a,{href:"/WebProgrammingToolsAndFrameworks/Advanced-Routing-Middleware/application-request-response-objects#resend",children:"res.end()"})," example). This will be useful when handling client / server errors and setting ",(0,n.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#client_error_responses",children:"4xx"})," / ",(0,n.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#server_error_responses",children:"5xx"})," series error codes. More detail is discussed in the following ",(0,n.jsx)(s.a,{href:"/WebProgrammingToolsAndFrameworks/Advanced-Routing-Middleware/middleware",children:'"Middleware"'})," section."]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}}}]);